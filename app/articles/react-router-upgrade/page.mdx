import Image from 'next/image';
import heroImage from './hero.webp';

export const metadata = {
  title: 'Upgrading React Router',
  description: 'How to upgrade to React Router from v3 to v6',
};

<Image
  src={heroImage}
  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
  priority
  alt="Hero Image"
  aria-hidden
/>

<article>
# Upgrading React Router from v3 to v6

We all know it is important to keep our dependencies upto date specially when it comes to
the ever changing world of Javascript, but there is always a deadline hanging over your head
or the current package is working fine so why bother upgrading it.

Something like this happened to us in [Sematext](https://sematext.com/) and we kept delaying
upgrade of React Router. We were still using React Router version 3 while 6 came out with
bunch of enticing features. To give you some context: Router v3.0.0 came out late 2016
and v6.0.0 came out in late 2021!

By mid 2022 we decided that it was high time we upgraded and I like our readers decided to google
how to upgrade from v3 to v6. But all articles I found were focused on upgrading it from v4/5 to v6.
Of course who would be crazy enough to upgrade from v3 to v6 ðŸ˜…. This is partly the reason I wanted
to write this article so I can share what its like upgrading a complex app from v3 to v6 and how to
solve the problems you might face.

## Major Changes

There were bunch of API changes between v3 and v6. I highly recommend reading the official migration
[guide](https://reactrouter.com/en/6.18.0/upgrading/v5). But as you can see from title it focused more
on migrating from version 5. So I have compiled a list of major changes that you need to be aware of
when upgrading from v3 to v6.

- Before React Router had its own version of `location.query` and all the libraries that depended on
  Router utilized this API. But by v6 the Router team had moved to using `URLSearchParams` which is
  a native [browser API](https://developer.mozilla.org/en-US/docs/Web/API/URL/searchParams).
- In v3 the Route component was passed a component as a prop but now element is passed as a prop. This
  allows you to pass props easily to component in our Route.
  ```js
  <Route path=":userId" element={<Profile animate={true} />} />
  ```
- `withRouter` HOC is no longer available in v6. Instead v6 promotes the use of hooks to access
  any router property you need.
- In v3, components that were passed to the `Route` element by default were passed router props.
  But now you have to specifically access them either using hooks or passing them as props.

- History package is no longer a peer dependency of React Router. Instead it is a direct dependency
  and its versioning is handled by React Router team. In fact you are recommended not to install it
  at all so that there are no conflicts.

There are a lot of other changes like `Switch` (introduced in v4) is now called `Routes`
and `Redirect` is now called `Navigate`. But the main focus of this article is how
we tackled the major challenges we faced in our large production app.

## Our Specific Challenges

To be continued...

  </article>
